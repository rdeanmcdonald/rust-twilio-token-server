#+title: REST CALLS

* Variables
#+name: environment
: local

* Environments
#+name: get-env
#+begin_src python :var env=environment key="host"
local = {
    "host": "http://localhost:8080"
}
prod = {
    "host": "http://localhost:80"
}

if env is "prod":
 return prod.get(key)

return local.get(key)
#+end_src

* Practice
#+begin_src restclient :var host=get-env()
GET :host/hey
#+end_src

#+begin_src restclient :var host=get-env()
GET :host/visitor/hey
#+end_src

#+begin_src restclient :var host=get-env()
POST :host/echo
Content-Type: application/json
Hey there!
#+end_src

* TOKEN
#+begin_src restclient :var host=get-env()
GET :host/token/some_id
#+end_src

#+begin_src restclient :var host=get-env()
GET :host/visitor/token/some_id
Authorization: Bearer enterprise_id
Origin: http://localhost:64610
#+end_src

#+RESULTS:
#+BEGIN_SRC js
Origin is not allowed to make this request
// GET http://localhost:8080/visitor/token/some_id
// HTTP/1.1 400 Bad Request
// content-length: 42
// vary: Origin, Access-Control-Request-Method, Access-Control-Request-Headers
// date: Mon, 04 Jul 2022 20:59:02 GMT
// Request duration: 0.002084s
#+END_SRC
